CREATE DATABASE Patentamientos0724;

Use Patentamientos0724;

CREATE TABLE Base(

tramite_tipo	VARCHAR(255) DEFAULT NULL,
tramite_fecha	VARCHAR(255) DEFAULT NULL,
fecha_inscripcion_inicial	VARCHAR(255) DEFAULT NULL,
registro_seccional_codigo	VARCHAR(255) DEFAULT NULL,
registro_seccional_descripcion	VARCHAR(255) DEFAULT NULL,
registro_seccional_provincia	VARCHAR(255) DEFAULT NULL,
automotor_origen	VARCHAR(255) DEFAULT NULL,
automotor_anio_modelo	VARCHAR(255) DEFAULT NULL,
automotor_tipo_codigo	VARCHAR(255) DEFAULT NULL,
automotor_tipo_descripcion	VARCHAR(255) DEFAULT NULL,
automotor_marca_codigo	VARCHAR(255) DEFAULT NULL,
automotor_marca_descripcion	VARCHAR(255) DEFAULT NULL,
automotor_modelo_codigo	VARCHAR(255) DEFAULT NULL,
automotor_modelo_descripcion	VARCHAR(255) DEFAULT NULL,
automotor_uso_codigo	VARCHAR(255) DEFAULT NULL,
automotor_uso_descripcion	VARCHAR(255) DEFAULT NULL,
titular_tipo_persona	VARCHAR(255) DEFAULT NULL,
titular_domicilio_localidad	VARCHAR(255) DEFAULT NULL,
titular_domicilio_provincia	VARCHAR(255) DEFAULT NULL,
titular_genero	VARCHAR(255) DEFAULT NULL,
titular_anio_nacimiento	VARCHAR(255) DEFAULT NULL,
titular_pais_nacimiento	VARCHAR(255) DEFAULT NULL,
titular_porcentaje_titularidad	VARCHAR(255) DEFAULT NULL,
titular_domicilio_provincia_id	VARCHAR(255) DEFAULT NULL,
titular_pais_nacimiento_id	VARCHAR(255) DEFAULT NULL,
base_cod MEDIUMINT PRIMARY KEY AUTO_INCREMENT
)

LOAD DATA INFILE 'dnrpa-inscripciones-iniciales-autos-202407.csv' 
INTO TABLE Base
FIELDS TERMINATED BY ';' 
ENCLOSED BY '"' 
LINES TERMINATED BY '\n' 
IGNORE 1 ROWS;

UPDATE base
SET automotor_modelo_codigo=NULL
WHERE automotor_modelo_codigo=""

UPDATE base
SET base.automotor_origen = NULL
WHERE base.automotor_origen = "" ;
